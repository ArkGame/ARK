sudo: required
language: cpp

env:
  global:
    - LANG="en_US.UTF-8"
    - COVERAGE=false

compiler:
  - gcc

# need gcc 4.9 and cmake
os:
  - linux
addons:
  apt:
    sources:
      #- ubuntu-toolchain-r-test
      - george-edison55-precise-backports
    packages:
      #- g++-4.9
      - cmake-data
      - cmake
      - lcov
    #sonarcloud
    sonarcloud:
        organization: "ark-game"
        token:
            secure: "ddzOfx+RRNCBteyQbwhTzB/r/gj8dTeTNOu5V9+4cAhMyaUoGzRMe2QYdknid/ichhNJ4eOcwAnmhil7XR1cIobpL52r05WL/+SYogy3U2cXAS9K4y/7To38GxdRXSx9mk0VTWjRW8A8wwVGOteOAuieW0jbXivgxUrGZEybqinzNj9ndLJ1iPapihVWQFy7GmQC3gIkLVLLa1d/ueYiilMOvIsbWjGdVFm3pyNXq2TUQurYuxYAVCYv9BTlj0EeyVHjKcL+OcMDJGSd8rUlLKl/HueM9pBXNi4w3zlVBZpccpJxYbXezf/DDSO7zJlYkBAZ+x6fzGFILVjvEhvdotz49f03/orJa3ofw+oOGYZn8wKQ0DnWSEva39+kLZsqMC+hEMbxcnc/4hUGmFia5HWYdjX3lTiWBGU8H+nhuVQ4XlJaBsN7fUCgfQFDiz0GrwwvXNxHkh2w484oYXVBCHi+T8Fxjmy7JetwkVf2UbCQ+g921peaQr+LeGno0VviJRSqvINlRaMqEu+1+X2/njee9VAQmkXe18bMOzrZjmSHZct5hAIjGNDl67gmZqQ7afI33+rQ7sG32v7jWp66hilYbDVgFnsYVCZKZqtDx/EDL22awKg+zMSrokORwcWIZVAe6R4LEJcUtiOIkpkqqZ7b8a5L2vOc0G0p4GBktR0="
before_install:
  # run build_dep.sh
  - pwd
  - cd Dep
  - chmod -R 755 build_dep.sh
  - ./build_dep.sh
  - cd ..

install:
    #- sudo pip install --upgrade pip
    #- sudo pip install codecov
  
before_script:
  # cmake
  - if [-d "build" ]; then rm -rf build; fi
  - mkdir build && cd build
  - cmake -G "Unix Makefiles" -DENABLE_COVERAGE=ON ..

script:
  # make
  - make -j 8
  - echo $TRAVIS_BUILD_DIR/Frame
  - cd $TRAVIS_BUILD_DIR/Frame
  - build-wrapper-linux-x86-64 --out-dir bw-output make all
  - sonar-scanner
    
after_success:
  #- bash <(curl -s https://codecov.io/bash)
  
cache:
  directories:
    - '$HOME/.sonar/cache'

notifications:
  email:
    - nickyang1988@qq.com
    - 410274624@qq.com
